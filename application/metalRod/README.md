# Application of Runge Kutta methods for solving ODE modeling thermic process of metal rod

Problem is given on: https://web.math.pmf.unizg.hr/~nela/zr2vjezbe/zr2_dif_jednadzbe.pdf

## Problem
![](problem.jpg?raw=true)

Strength of metal is controlled by its chemical composition and steps of mechanical design that were used to get it. After melted metal hardens, but before cooling completely, it is shaped into levers, plates or rods. Then, metal is left to cool and after it is subjected to carefully controlled changes of temperature in process called Thermic processing. 
Simple model of thermical processing is given by non-linear first order ODE for temperature of metal as function of time.
Steel is shaped into long rods which are heated so the stress gained during shaping is released. Rods are heated by letting the electricity through. After rods gain certain temperature, electricity is turned off and ventilators turn on to cool them. In both fases, heating and cooling, rods exchange heat with the environment by convection and radiation. Heat transfer by convection happend because of moving air around the rods and is modeled by equation
<p align="center"><img src="svgs/7748eecfd3161ea96b6f1750a6f171fb.svg" align=middle width=139.313955pt height=16.97751pt/></p>
where Q<sub>k</sub> is power of cooling by convection, H is empirical constant called coefficient of heat transfer, A<sub>p</sub> is area of the rods cape, T is temperature of the rod (assuming it is uniform) and T<sub>0</sub> is the temperature of the air (environment). Heat transfer by radiation happens by means of electromagnetic waves in infrared spectrum. Rods exchange heat with any other surface in visible range. We assume that all of them have the temperature T<sub>0</sub>
In that case the model is
<p align="center"><img src="svgs/f94b405f090d27ff2cbd44071abf4282.svg" align=middle width=154.65334499999997pt height=18.869894999999996pt/></p>
Q<sub>z</sub> is the power of cooling by radiation, `\epsilon` is the relative power of heat radiation that the rods area has, `\sigma` is Stefan-Boltzmanns constant.
Temperature in heat transfer by radiation has to be in °K, it can be switched to °C later. 
At each moment, the energy equilibrium is given by
<p align="center"><img src="svgs/c7d12f8fb8283891494a08d5822d49bf.svg" align=middle width=168.5277pt height=33.769394999999996pt/></p>,
where t is time, m is the mass of the rod, c is specific heat capacity and Q<sub>e</sub> is power of heat generated by electricity. 
The ODE describing the model is 
<p align="center"><img src="svgs/967b9cf4974d2e6d003910f97e337d70.svg" align=middle width=371.6493pt height=33.769394999999996pt/></p>.
Since thermic processing is conducted in two phases:
	- heating by electricity is on and ventilators are off : heating (free convection)
	- heating is off and vectilators are on : cooling (forced convection)
we have the following situation
<p align="center"><img src="svgs/4e2f56101d03077949430d85e7bc5016.svg" align=middle width=151.207485pt height=39.30498pt/></p>
Where t<sub>h</sub> is the moment when heating is turned off and cooling is turned on. 




## Solution to the ODE of the problem
![](im1.jpg?raw=true)

To answer the question to which method (ode_rk23 or ode_rk4) is more accurate, I plot this image with doubling the subdivision for ode_rk4 to determine that the ode_rk23 is more accurate with half the points needed. 

![](im2.jpg?raw=true)
